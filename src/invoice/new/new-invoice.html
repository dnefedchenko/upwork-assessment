<ng-template #resultTemplate let-r="result" let-t="term">
    {{r.name}}
</ng-template>

<div>
    <h3>New Invoice</h3>

    <form [formGroup]="invoiceForm" class="form-horizontal">
        <div class="form-inline">
            <label for="customer">Customer:&nbsp;</label>
            <select id="customer" class="form-control" formControlName="customer">
                <option *ngFor="let customer of customers" [ngValue]="customer">{{customer.name}}</option>
            </select>

            <label for="discount">&nbsp;&nbsp;Discount(%):&nbsp;&nbsp;</label>
            <input id="discount" type="number" class="form-control" min="0" formControlName="discount">

            <label><strong>&nbsp;&nbsp;Total($):&nbsp;&nbsp;{{cost}}</strong></label>
        </div>


        <div class="form-group" style="margin-top: 10px;">
            <h4>Products</h4>

            <input type="text" class="form-control" [ngbTypeahead]="productSearch"
                   [inputFormatter]="productFormatter" [resultTemplate]="resultTemplate"
                   (selectItem)="addProduct($event)">

            <table class="table" formArrayName="products">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let product of invoiceForm.get('products').controls; let i = index;" [formGroupName]="i">
                            <td>
                                <span class="glyphicon glyphicon-trash" aria-hidden="true" (click)="removeProduct(i)"></span>
                            </td>
                            <td>
                                <input type="text" class="form-control" formControlName="name">
                            </td>
                            <td>
                                <input type="text" class="form-control" formControlName="price">
                            </td>
                            <td>
                                <input type="number" class="form-control qty-input" min="0" formControlName="quantity">
                            </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="form-group">
            <button type="button" class="btn btn-primary pull-right" (click)="saveInvoice()">Save Invoice</button>
        </div>

    </form>
</div>